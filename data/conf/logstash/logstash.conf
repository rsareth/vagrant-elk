input {
  file {
    type => "microsoft_ad"
    path => "/vagrant_data/idm/Microsoft - AD.log"
    start_position => "beginning"
    codec => multiline {
        negate => true
        #pattern => "[%{DATE_US} %{TIME}.%{NUMBER:MILLISECOND:int}]:%{ACTIVE_DIRECTORY}:"
        pattern => "^(<|([ ]*<))|[ ]*[a-zA-z0-9]*"
        what => previous
    }
  }
#  file {
#    type => "novell_edir"
#    path => "/vagrant_data/idm/Novell - eDir.log"
#    start_position => "beginning"
#  }
#  file {
#    type => "novell_eos"
#    path => "/vagrant_data/idm/Novell - EOS.log"
#    start_position => "beginning"
#  }
#  file {
#    type => "sun_ldap"
#    path => "/vagrant_data/idm/Sun - LDAP.log"
#    start_position => "beginning"
#  }
}

filter {
  grok {
    match => { "message" => "%{COMBINEDAPACHELOG}" }
  }
  date {
  match => [ "timestamp" , "dd/MMM/yyyy:HH:mm:ss Z" ]
  }
}

output {
#  elasticsearch {
#    host => localhost
#  }
  stdout { codec => rubydebug }
}
